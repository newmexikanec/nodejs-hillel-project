<%- include('header'); -%>
<%- include('navigationbar'); -%>
<main class="container">
        <div class="row">
            <div class="col-lg-3"></div>
            <div class="col-lg">
                <% if (loggedin) { %>
                    <div class="card shadow mt-2">
                        <h6 class="card-header text-center"><%= companion %></h6>
                        <div class="chat-box" chat-id="<%= chatID %>">
                            <% messages.forEach(itm => { %>
                                <div class="media-chat <%= userID === itm.senderID.toString() ? 'media-chat-reverse' : '' %>">
                                    <% const date = new Date(itm.date); %>
                                    <% const minutes = date.getMinutes(); %>
                                    <p><%=itm.text%><span><%= date.getHours() %>:<%= minutes < 10 ? '0' + minutes : minutes %></span></p>
                                </div>
                            <% }) %>
                        </div>
                        <div class="publisher bt-1 border-light">
                            <input class="publisher-input" type="text" placeholder="Write something">
                            <div class="send-btn text-end">
                                <svg width="32" height="32" id="send_message">
                                    <g id="Fill">
                                        <path d="M28.11,13.32,2.13,2.1,7.44,14.85a3.05,3.05,0,0,1,0,2.3L2.13,29.88l26-11a3,3,0,0,0,0-5.51ZM27.31,17,5.87,26.12l3.41-8.2A4.42,4.42,0,0,0,9.56,17H20V15H9.56a4.42,4.42,0,0,0-.28-.92L5.87,5.9l21.45,9.25a1,1,0,0,1,.6.92A1,1,0,0,1,27.31,17Z"/>
                                    </g>
                                </svg>
                            </div>
                        </div>
                    </div>
                    <script type="module" src="/assets/chat.js" defer></script>
                <% } else { %>
                    <div class="text-center">
                        <h5>You do not have permission to access</h5>
                    </div>
                <% } %>
            </div>
            <div class="col-lg-3"></div>
    </div>
</main>
<%- include('footer'); -%>
